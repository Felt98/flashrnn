Forward (input: HIDDEN_DIM, BATCH_DIM):

Inputs:
WARP_SIZE == 32
WARP_TILING_DIM_RGATE == 32
WARP_TILING_DIM_BATCH == 8
WARP_TILING_DIM_HIDDEN == 16
MAX_THREADS_PER_BLOCK == 1024
STREAMING_MULTIPROCESSORS == 108 (A100)
SHARED_MEMORY_PER_BLOCK == 165000
RECURRENT_GATES == 1 (HIN), 4
INPUTBASED_GATES == 3 (HIN), 4


Outputs:
RECURRENT_TILING_COUNT_HIDDEN
RECURRENT_TILING_COUNT_GATE
(BATCH_TILING_COUNT)
WARP_TILING_COUNT_BATCH
WARP_TILING_COUNT_HIDDEN
WARP_TILING_COUNT_RGATE


Constraints:

RECURRENT_GATES * HIDDEN_DIM % (RECURRENT_TILING_COUNT_GATE * WARP_TILING_DIM_RGATE) == 0
RECURRENT_GATES * HIDDEN_DIM * WARP_TILING_COUNT_HIDDEN <= MAX_THREADS_PER_BLOCK * RECURRENT_TILING_COUNT_GATE
WARP_TILING_COUNT_BATCH * WARP_TILING_DIM_BATCH (* BATCH_TILING_COUNT) == BATCH_DIM
NUM_BLOCKS < STREAMING_MULTIPROCESSORS
NUM_BLOCKS == RECURRENT_TILING_COUNT_GATE * RECURRENT_TILING_COUNT_HIDDEN (* BATCH_TILING_COUNT)
RECURRENT_GATES * HIDDEN_DIM % RECURRENT_TILING_COUNT_GATE == 0
HIDDEN_DIM % RECURRENT_TILING_COUNT_HIDDEN == 0

Constraints Bfloat16:
2 * RECURRENT_GATES * HIDDEN_DIM * HIDDEN_DIM / RECURRENT_TILING_COUNT_GATE / RECURRENT_TILING_COUNT_HIDDEN + 4 * RECURRENT_GATES * HIDDEN_DIM / RECURRENT_TILING_COUNT_GATE < SHARED_MEMORY_PER_BLOCK

Constraints Float16:
2 * RECURRENT_GATES * HIDDEN_DIM * HIDDEN_DIM / RECURRENT_TILING_COUNT_GATE / RECURRENT_TILING_COUNT_HIDDEN + 2 * RECURRENT_GATES * HIDDEN_DIM / RECURRENT_TILING_COUNT_GATE < SHARED_MEMORY_PER_BLOCK



Backward:

Inputs:
WARP_TILING_DIM_HIDDEN == 32
WARP_TILING_DIM_RGATE == 16

Outputs:
RECURRENT_TILING_COUNT_HIDDEN
RECURRENT_TILING_COUNT_GATE
(BATCH_TILING_COUNT)
WARP_TILING_COUNT_BATCH
WARP_TILING_COUNT_HIDDEN
WARP_TILING_COUNT_RGATE

Constraints:
HIDDEN_DIM % (RECURRENT_TILING_COUNT_HIDDEN * WARP_TILING_COUNT_HIDDEN) == 0
HIDDEN_DIM * WARP_TILING_COUNT_RGATE <= MAX_THREADS_PER_BLOCK * RECURRENT_TILING_COUNT_HIDDEN
HIDDEN_DIM % RECURRENT_TILING_COUNT_HIDDEN == 0
RECURRENT_GATES * HIDDEN_DIM % RECURRENT_TILING_COUNT_GATE == 0

WARP_TILING_COUNT_BATCH * WARP_TILING_DIM_BATCH (* BATCH_TILING_COUNT) == BATCH_DIM
NUM_BLOCKS < STREAMING_MULTIPROCESSORS
NUM_BLOCKS == RECURRENT_TILING_COUNT_GATE * RECURRENT_TILING_COUNT_HIDDEN (* BATCH_TILING_COUNT)

Constraints Bfloat16:
2 * RECURRENT_GATES * HIDDEN_DIM * HIDDEN_DIM / RECURRENT_TILING_COUNT_GATE / RECURRENT_TILING_COUNT_HIDDEN + 4 * HIDDEN_DIM / RECURRENT_TILING_COUNT_HIDDEN < SHARED_MEMORY_PER_BLOCK

Constraints Float16:
2 * RECURRENT_GATES * HIDDEN_DIM * HIDDEN_DIM / RECURRENT_TILING_COUNT_GATE / RECURRENT_TILING_COUNT_HIDDEN + 2 * HIDDEN_DIM / RECURRENT_TILING_COUNT_HIDDEN < SHARED_MEMORY_PER_BLOCK
