# 基本配置
FLASHRNN_HIDDEN_DIM = 384
FLASHRNN_NUM_HEADS = 12
FLASHRNN_FORWARD_CLIPVAL = 0.0
head_dim = 32
'-DFLASHRNN_NUM_GATES_R=3'
'-DFLASHRNN_NUM_GATES_W=3'
'-DFLASHRNN_NUM_GATES_I=4'
'-DFLASHRNN_NUM_GATES_T=4'

# Shared Memory Padding
FLASHRNN_FORWARD_SHARED_MEMORY_PADDING = 8

# Warp Tiling Dimensions - Forward
FLASHRNN_FORWARD_WARP_TILING_DIM_HIDDEN = 16
FLASHRNN_FORWARD_WARP_TILING_DIM_BATCH = 16
FLASHRNN_FORWARD_WARP_TILING_DIM_GATE = 16

# Multihead Tiling Count
FLASHRNN_FORWARD_MULTIHEAD_TILING_COUNT = 12

# Recurrent Tiling Count - Forward
FLASHRNN_FORWARD_RECURRENT_TILING_COUNT_GATE = 6     # 单个 head 中，4D 方向有 6 个 tile (block)
FLASHRNN_FORWARD_RECURRENT_TILING_COUNT_HIDDEN = 1   # 单个 head 中，D(H) 方向 1 个 tile (block)

# Block Tiling Count (Batch)
FLASHRNN_FORWARD_BLOCK_TILING_COUNT_BATCH = 1

# Warp Looping Count - Forward
FLASHRNN_FORWARD_WARP_LOOPING_COUNT_BATCH = 1
FLASHRNN_FORWARD_WARP_LOOPING_COUNT_GATE = 1

# Warp Tiling Count - Forward
FLASHRNN_FORWARD_WARP_TILING_COUNT_BATCH = 1
FLASHRNN_FORWARD_WARP_TILING_COUNT_HIDDEN = 2        # D(H) 方向上每个 block 有 2 个 warp

# Recurrent Cached Flags
FLASHRNN_FORWARD_WARP_RECURRENT_CACHED_HIDDEN = 1